<!DOCTYPE html>
<html>
<head>
    <meta content="" charset="utf-8" />
    <title>@ViewData("Title")</title>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
    <script type="text/javascript" language="javascript">
        // used to keep an array of navigation object
        var mUIControls = new Array();

        // Object to contain information related to
        // updating a "ContentArea" using ajax.
        // The action should be used withing the ajax call
        // to supply the data to rendor the given
        // section of the UI
        function NavObject() {
            //properties
            this.Action = '';
            this.ContentArea = '';
            //methods
            this.Refresh = function refresh() {
                if (this.Action.length > 0 && this.ContentArea.length > 0) {
                    $('#' + this.ContentArea).html(this.Action.toString());
                }
            }
            this.Load = function load() {
                if (this.Action.length > 0 && this.ContentArea.length > 0) {
                    //alert('loading: ' + this.ContentArea + ' using action: ' + this.Action);
                }
            }

            return true;
        }

        function UIControler() {
            // Methods
            this.Register = function (NavObject) {
                if (!contains(NavObject)) {
                    mUIControls.push(NavObject);
                }

            };

            this.Load = function load(navObject) {
                navObject.Load();
            }

            this.LoadAll = function loadAll() {
                for (var i = 0; i < mUIControls.length; i++) {
                    mUIControls[i].Load();
                }
            }

            this.Refresh = function refresh() {
                for (var i = 0; i < mUIControls.length; i++) {
                    mUIControls[i].Refresh();
                }
            }
            function contains(obj) {
                for (var i = 0; i < mUIControls.length; i++) {
                    if (mUIControls[i] === obj) {
                        return true;
                    }
                }
                return false;
            }
            // Properties
            this.Count = function count() {
                return mUIControls.length;
            }

            return true;
        }

        function InitPageNavigation() {
            var mUIControler = new UIControler();
            var mNavObject = new NavObject();
            mNavObject.Action = 'Title Action';
            mNavObject.ContentArea = 'title';
            mUIControler.Register(mNavObject);

            var mNavObject = new NavObject();
            mNavObject.Action = 'MainContent Action';
            mNavObject.ContentArea = 'main';
            mUIControler.Register(mNavObject);
        }

        function Refresh() {
            var mUIControler = new UIControler();
            mUIControler.Refresh();
        }

        $(document).ready(function () {
            InitPageNavigation()
        });
    </script>
</head>
<body>
    <div class="page">
        <header>
            <div id="title">
                <h1>My MVC Application</h1>
            </div>
            <div id="logindisplay">
                @Html.Partial("_LogOnPartial")
            </div>
            <nav>
                <ul id="menu">
                    <li>@Html.ActionLink("Home", "Index", "Home")</li>
                    <li>@Html.ActionLink("About", "About", "Home")</li>
                    @If Request.IsAuthenticated Then
                       @:<li> @Html.ActionLink("Functions", "Index", "Functions") </li>
                    End If
                </ul>
            </nav>
        </header>
        <input type="button" id="button" onclick="javascript:Refresh();" value="Refresh" />
        <section>
            <div id="main">
                initial
            </div>
            @RenderBody()
        </section>
        <footer>
        </footer>
    </div>
</body>
</html>
