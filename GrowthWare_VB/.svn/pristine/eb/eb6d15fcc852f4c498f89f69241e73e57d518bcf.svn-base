Imports System.Collections.ObjectModel
Imports System.Web
Imports System.Linq
Imports GrowthWare.Framework.BusinessLogicLayer
Imports GrowthWare.Framework.Common
Imports GrowthWare.Framework.ModelObjects
Namespace Utilities
	Public Class FunctionUtility
		Private m_SecurityEntityProfile As MSecurityEntityProfile = Nothing
		Private m_BFunctions As BFunctions = Nothing


		Public Sub New()
			Dim mSecurityUtility = New SecurityEntityUtility()
			m_SecurityEntityProfile = mSecurityUtility.GetCurrentProfile()
			m_BFunctions = New BFunctions(m_SecurityEntityProfile, ConfigSettings.CentralManagement)
		End Sub

		Public Function GetFunctions() As Collection(Of MFunctionProfile)
			' need code to handle caching
			'Dim mFunctionCollection As MFunctionProfileCollection
			Dim mFunctionCollection As Collection(Of MFunctionProfile)
			mFunctionCollection = m_BFunctions.GetFunctions(m_SecurityEntityProfile.Id)
			Return mFunctionCollection
		End Function

		Public Function GetFunction(ByVal action As String) As MFunctionProfile
			Dim mResult = From mProfile In GetFunctions() Where mProfile.Action = action Select mProfile
			Dim mRetVal As MFunctionProfile = mResult.First
			Return mRetVal
		End Function

		Public Function GetFunction(ByVal id As Integer) As MFunctionProfile
			Dim mResult = From mProfile In GetFunctions() Where mProfile.Id = id Select mProfile
			Dim mRetVal As MFunctionProfile = mResult.First
			Return mRetVal
		End Function
	End Class
End Namespace
