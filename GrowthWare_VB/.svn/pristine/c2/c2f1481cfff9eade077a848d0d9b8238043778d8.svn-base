Imports GrowthWare.Framework.ModelObjects.Base.Interfaces
Imports System.Collections.ObjectModel
Imports GrowthWare.Framework.Enumerations

Namespace ModelObjects
	''' <summary>
	''' MFunctionProfile contains properties from the ZF_FUNCTIONS table.
	''' </summary>
	''' <remarks></remarks>
	<Serializable(), CLSCompliant(True)> _
	Public Class MFunctionProfile
		Inherits MSecurity
		Implements IMProfile

#Region "Member Fields"
		Private m_Function_Seq_ID As Integer = -1
		Private m_Nav_Type_Seq_ID As Integer = 2
		Private m_Function_Type_Seq_ID = -1
		Private m_ALLOW_HTML_INPUT As Integer = 1
		Private m_ALLOW_COMMENT_HTML_INPUT As Integer = 1
		Private m_ParentmFunction_Seq_ID As Integer = 1
#End Region

		''' <summary>
		''' Will return a Function profile with the default vaules
		''' </summary>
		''' <remarks></remarks>
		Public Sub New()

		End Sub

		''' <summary>
		''' Will return a fully populated Function profile.
		''' </summary>
		''' <param name="drowProfile">A data row containing the Function information</param>
		''' <param name="drowSecurity">A data row containing all of the roles</param>
		''' <remarks></remarks>
		Public Sub New(ByVal profileDatarow As DataRow, ByVal securityDatarow() As DataRow)
			Initialize(profileDatarow, securityDatarow)
		End Sub

		Protected Overloads Sub Initialize(ByVal profileDatarow As DataRow, ByVal securityDatarow() As DataRow)
			On Error Resume Next
			MyBase.Initialize(profileDatarow, securityDatarow)
			MyBase.Id = CInt(profileDatarow("FUNCTION_SEQ_ID"))
			m_Function_Type_Seq_ID = Me.GetInt(profileDatarow, "FUNCTION_TYPE_SEQ_ID")
			Name = Me.GetString(profileDatarow, "NAME")
			Description = Me.GetString(profileDatarow, "DESCRIPTION")
			Notes = Me.GetString(profileDatarow, "NOTES")
			Source = Me.GetString(profileDatarow, "SOURCE")
			EnableViewState = Me.GetBool(profileDatarow, "ENABLE_VIEW_STATE")
			EnableNotifications = Me.GetBool(profileDatarow,"ENABLE_NOTIFICATIONS")
			RedirectOnTimeout = Me.GetBool(profileDatarow, "REDIRECT_ON_TIMEOUT")
			IsNav = Me.GetBool(profileDatarow, "IS_NAV")
			LinkBehavior = Me.GetInt(profileDatarow, "Link_Behavior")
			No_UI = Me.GetBool(profileDatarow, "No_UI")
			NAV_TYPE_SEQ_ID = Me.GetInt(profileDatarow, "NAVIGATION_NVP_SEQ_DET_ID")
			m_ParentmFunction_Seq_ID = Me.GetInt(profileDatarow, "PARENT_Function_Seq_ID")
			Action = Me.GetString(profileDatarow, "ACTION")
			' need to set the the base class name with the action.
			' the names can repeate but the action is unique and lower case.
			MyBase.Name = Action.ToLower
			MetaKeyWords = Me.GetString(profileDatarow, "META_KEY_WORDS")
		End Sub

		''' <summary>
		''' Represents the Action to be take within the system.
		''' </summary>
		''' <remarks>This is a unique value</remarks>
		Public Property Action() As String

		Public Property Description() As String

		Public Property EnableViewState() As Boolean

		Public Property EnableNotifications() As Boolean

		''' <summary>
		''' Use to determin if a function is a navigation function
		''' </summary>
		''' <remarks>
		''' Should be replaced by LinkBehavior
		''' </remarks>
		Public Property IsNav() As Boolean

		''' <summary>
		''' Replresents the link behavior of a function.
		''' </summary>
		''' <returns>Integer</returns>
		''' <remarks>
		''' Data stored in ZGWSecurity.Functions and related to ZGWCoreWeb.Link_Behaviors
		''' </remarks>
		Public Property LinkBehavior() As Integer

		Public Property Function_Type_Seq_ID() As Integer
			Get
				Return m_Function_Type_Seq_ID
			End Get
			Set(ByVal value As Integer)
				m_Function_Type_Seq_ID = value
			End Set
		End Property

		Public Property MetaKeyWords() As String

		Public Shadows Property Name() As String

		Public Property NAV_TYPE_SEQ_ID() As Integer
			Get
				Return m_Nav_Type_Seq_ID
			End Get
			Set(ByVal Value As Integer)
				m_Nav_Type_Seq_ID = Value
			End Set
		End Property

		Public Property Notes() As String

		Public Property No_UI() As Boolean

		Public Property ParentID() As Integer
			Get
				Return m_ParentmFunction_Seq_ID
			End Get
			Set(ByVal Value As Integer)
				m_ParentmFunction_Seq_ID = Value
			End Set
		End Property

		Public Property RedirectOnTimeout() As Boolean

		Public Property Source() As String

	End Class
End Namespace